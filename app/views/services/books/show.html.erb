<!-- Book Title -->
<h1><%= @book.title.titleize %></h1>

<div class="row">

  <div class="col">

    <!-- Book Information -->
    <section class="book-information">

      <div class="box">

        <!-- Book metadata -->
        <div class="metadata">

          <% if user_is_management %>

            <!-- User -->
            <%= link_to @book.user.full_name, user_path(@book.user) %> 
            
            <% if @book.user.note.present? %>
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-journal" viewBox="0 0 16 16">
                <path d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z"/>
                <path d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z"/>
              </svg>
            <% end %>
            
            |
          <% end %>

          <!-- Language -->
          <%= @book.language.titleize %> |

          <!-- Genre -->
          <%= @book.genre.genre_type.titleize %> | 

          <!-- Word count -->
          <%= number_with_delimiter(@book.word_count) %>

          <!-- Edit book detials -->
          <%= link_to edit_services_book_path(@book) do %>
            [ Update Book]
          <% end %>

        </div>

        <!-- Book Description -->
        <div class="accordion mt-3" id="accordionExample">
          <div class="accordion-item">
            <h2 class="accordion-header" id="headingTwo">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                Book Description
              </button>
            </h2>
            <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
              <div class="accordion-body">

                <%= form_for([:services, @book]) do |form| %>

                  <div class="input">
                      <%= form.rich_text_area :description, type: "text", class: "form-control", rows: "35" %>
                  </div>

                  <div class="button">
                    <%= form.button "Update Description", type: "submit", class: 'btn btn-outline-primary btn-sm', data: {disable_with: "<i class='fa fa-spinner fa-spin'></i> Saving..."}  %>
                  </div>     

                <% end %>

              </div>
            </div>
          </div>
        </div>

      </div>

    </section>

  </div>

</div>

<!-- Service panel -->
<section class="service-panel">

    <% if @book.dev_edit_samples.blank? && @book.dev_edits.blank? %>

      <!-- No sample or full edit submitted -->
      <section class="mt-3 mt-lg-0">

        <div class="row">

          <div class="col">

            <div class="alert alert-success text-center">
              <p>To proceed, either submit your manuscript for a <strong>free sample developmental edit</strong>, OR submit for <strong>full developmental editing</strong>.</p>   
            </div>

          </div>

        </div>

        <div class="row">

          <div class="col-lg-6 align-items-stretch mt-2 mt-lg-0">
            <div class="box">
              <h2>Free Sample Editing</h2>
              <%= render 'services/dev_edit_samples/form', dev_edit_sample: @book.dev_edit_samples.build %>
            </div>
          </div>

          <div class="col-lg-6 align-items-stretch mt-2 mt-lg-0">
            <div class="box">
              <h2>Full Developmental Editing</h2>
              <%= render 'services/dev_edits/form', dev_edit: @book.dev_edits.build %>
            </div>

        </div>

      </section>

    <% elsif @book.dev_edit_samples.present? && @sample_developmental_edit.status == "sample_developmental_edit_rejected" %>

      <!-- Sample rejected -->
      <section class="mt-3 mt-lg-0">

        <div class="row mt-3">

          <!-- Sample developmental edit status -->
          <div class="col-lg-8">

            <div class="box">
            
              <h3>Sample Developmental Editing</h3>
              <%= render "services/status_messages/sample_developmental_edits/#{@sample_developmental_edit.status}", sample_developmental_edit: @sample_developmental_edit %>
            
            </div>

          </div>

          <!-- Sample developmental edit files -->
          <div class="col-lg-4">

            <div class="box">
            
              <h3>Files</h3>
              <%= render "services/status_messages/sample_developmental_edits/files", sample_developmental_edit: @sample_developmental_edit %>
            
            </div>

          </div>

        </div>


      </section>


    <% elsif @book.dev_edit_samples.present? && @sample_developmental_edit.status != "sample_developmental_edit_returned" %>

      <!-- Sample submitted but not complete -->
      <section class="mt-3 mt-lg-0">

        <div class="row mt-3">

          <!-- Sample developmental edit status -->
          <div class="col-lg-8">

            <div class="box">
            
              <h3>Sample Developmental Editing</h3>
              <%= render "services/status_messages/sample_developmental_edits/#{@sample_developmental_edit.status}" %>         
            
            </div>

          </div>

          <!-- Sample developmental edit files -->
          <div class="col-lg-4">

            <div class="box">
            
              <%= render "services/status_messages/files" %>
            
            </div>

          </div>

        </div>

      </section>


    <% elsif @book.dev_edit_samples.present? && @sample_developmental_edit.status == "sample_developmental_edit_returned" && @book.dev_edits.blank? %>  

      <!-- Sample returned -->
      <section class="mt-3 mt-lg-0">

        <div class="row mt-3">

          <!-- Sample developmental edit status -->
          <div class="col-lg-8">

            <div class="box">
            
              <h3>Sample Developmental Editing</h3>
              <%= render "services/status_messages/sample_developmental_edits/#{@sample_developmental_edit.status}" %>         
            
            </div>

          </div>

          <!-- Sample developmental edit files -->
          <div class="col-lg-4">

            <div class="box">
            
              <%= render "services/status_messages/files" %>
            
            </div>

          </div>

        </div>

      </section>

    <!-- Edit submitted -->
    <% elsif @book.dev_edits.present? %>

      <section class="mt-3 mt-lg-0">

        <div class="row mt-3">

          <!-- Developmental edit status -->
          <div class="col-lg-8">

            <div class="box">
            
              <h3>Developmental Editing</h3>
               <%= render "services/status_messages/developmental_edits/#{@developmental_edit.status}" %>

            </div>

          </div>

          <!-- Developmental edit files -->
          <div class="col-lg-4">

            <div class="box">
            
              <%= render "services/status_messages/files" %>
            
            </div>

          </div>

        </div>

      </section>

    <% end %>

  </section>


