<h1>Messages</h1>
 
<%= turbo_stream_from 'messages'%>

<%= turbo_frame_tag 'messages' do %>
  <%= render @messages %>
<% end %>

<div class="box">

  <ul class="nav nav-tabs" id="myTab" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link active" id="inbox-tab" data-bs-toggle="tab" data-bs-target="#inbox" type="button" role="tab" aria-controls="writer" aria-selected="true">Inbox</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="archive-tab" data-bs-toggle="tab" data-bs-target="#archive" type="button" role="tab" aria-controls="editor" aria-selected="false">Archive</button>
    </li>
  </ul>

  <div class="tab-content" id="myTabContent">

    <div class="tab-pane fade show active" id="inbox" role="tabpanel" aria-labelledby="inbox-tab">
    
      <table class="table table-hover mt-4">
          <thead>
            <tr>
              <th scope="col">Name</th>
              <th scope="col">Email</th>
              <th scope="col">Date</th>
              <th scope="col">Status</th>
            </tr>
          </thead>

          <tbody>
            <% @unread_messages.each do |message| %>
              <tr style="font-weight:bold">
                <th scope="row">
                  <svg width="0.7em" height="0.7em" viewBox="0 0 16 16" class="bi bi-circle-fill text-primary" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="8" cy="8" r="8"/>
                  </svg>
                  <%= link_to message.sender_name, message_path(message) %>
                </th>
                <td><%= message.sender_email %></td>
                <td><%= message.created_at.strftime("%d/%m/%Y")  %></td>
                <td>
                  <% if message.read? %>
                    <%= link_to unread_message_path(message), method: :put do %>
                        <span class="badge bg-secondary">Mark as Unread</span>
                    <% end %>
                  <% else %>
                    <%= link_to read_message_path(message), method: :put do %>
                        <span class="badge bg-secondary">Mark as Read</span>
                    <% end %>
                  <% end %> 
                
                <%= link_to archive_message_path(message), method: :put do %>
                  <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-archive" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M0 2a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1v7.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 12.5V5a1 1 0 0 1-1-1V2zm2 3v7.5A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5V5H2zm13-3H1v2h14V2zM5 7.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"/>
                  </svg>
                <% end %>

                <%= link_to message_path(message), data: { "turbo-method": :delete, confirm: "Are you sure you want to kill this bad boy?"} do %>
                  <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-trash" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                    <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4L4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                  </svg>
                <% end %>
                </td>
              </tr>
            <% end %>

            <% @read_messages.each do |message| %>
              <tr>
                <th>
                  <%= link_to message.sender_name, message_path(message) %>
                </th>
                <td><%= message.sender_email %></td>
                <td><%= message.created_at.strftime("%d/%m/%Y")  %></td>
                <td>
                  <% if message.read? %>
                    <%= link_to unread_message_path(message), method: :put do %>
                        <span class="badge badge-light">Mark as Unread</span>
                    <% end %>
                  <% else %>
                    <%= link_to read_message_path(message), method: :put do %>
                        <span class="badge badge-success">Mark as Read</span>
                    <% end %>
                <% end %> 

                <%= link_to archive_message_path(message), method: :put do %>
                  <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-archive" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M0 2a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1v7.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 12.5V5a1 1 0 0 1-1-1V2zm2 3v7.5A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5V5H2zm13-3H1v2h14V2zM5 7.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"/>
                  </svg>
                <% end %>

                <%= link_to message_path(message), method: :delete, data: { confirm: "Are you sure you want to kill this bad boy?"} do %>
                  <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-trash" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                    <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4L4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                  </svg>
                <% end %>
                </td>
              </tr>
            <% end %>

          </tbody>
        </table>
    
    </div> 

    <div class="tab-pane fade show" id="archive" role="tabpanel" aria-labelledby="archive-tab">
    
        <table class="table table-hover mt-4">
          <thead>
            <tr>
              <th scope="col">Name</th>
              <th scope="col">Email</th>
              <th scope="col">Date</th>
              <th scope="col">Status</th>
            </tr>
          </thead>

          <tbody>
            <% @archived_messages.each do |message| %>
              <tr style="font-weight:bold">
                <th scope="row">
                  <svg width="0.7em" height="0.7em" viewBox="0 0 16 16" class="bi bi-circle-fill text-primary" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="8" cy="8" r="8"/>
                  </svg>
                  <%= link_to message.sender_name, message_path(message) %>
                </th>
                <td><%= message.sender_email %></td>
                <td><%= message.created_at.strftime("%d/%m/%Y")  %></td>
                <td>
                  <% if message.read? %>
                    <%= link_to unread_message_path(message), method: :put do %>
                        <span class="badge bg-warning">Mark as Unread</span>
                    <% end %>
                  <% else %>
                    <%= link_to read_message_path(message), method: :put do %>
                        <span class="badge badge-success">Mark as Read</span>
                    <% end %>
                  <% end %> 
                
                <%= link_to archive_message_path(message), method: :put do %>
                  <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-archive" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M0 2a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1v7.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 12.5V5a1 1 0 0 1-1-1V2zm2 3v7.5A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5V5H2zm13-3H1v2h14V2zM5 7.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"/>
                  </svg>
                <% end %>

                <%= link_to message_path(message), method: :delete, data: { confirm: "Are you sure you want to kill this bad boy?"} do %>
                  <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-trash" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                    <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4L4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                  </svg>
                <% end %>
                </td>
              </tr>
            <% end %>

            <% @read_messages.each do |message| %>
              <tr>
                <th>
                  <%= link_to message.sender_name, message_path(message) %>
                </th>
                <td><%= message.sender_email %></td>
                <td><%= message.created_at.strftime("%d/%m/%Y")  %></td>
                <td>
                  <% if message.read? %>
                    <%= link_to unread_message_path(message), method: :put do %>
                        <span class="badge badge-light">Mark as Unread</span>
                    <% end %>
                  <% else %>
                    <%= link_to read_message_path(message), method: :put do %>
                        <span class="badge badge-success">Mark as Read</span>
                    <% end %>
                <% end %> 

                <%= link_to archive_message_path(message), method: :put do %>
                  <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-archive" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M0 2a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1v7.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 12.5V5a1 1 0 0 1-1-1V2zm2 3v7.5A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5V5H2zm13-3H1v2h14V2zM5 7.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"/>
                  </svg>
                <% end %>

                <%= link_to message_path(message), method: :delete, data: { confirm: "Are you sure you want to kill this bad boy?"} do %>
                  <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-trash" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                    <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4L4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                  </svg>
                <% end %>
                </td>
              </tr>
            <% end %>

          </tbody>
        </table>
    
    </div> 

  </div>

</div>





